<h1>数据库事务</h1>

数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。 事务处理可以确保除非事务性单元内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功要么全部失败的单元，可以简化错误恢复并使应用程序更加可靠。一个逻辑工作单元要成为事务，必须满足所谓的ACID（原子性、一致性、隔离性和持久性）属性。

</h2>ACID属性</h2>

### Atomicity(原子性)
一个事务必须被视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作。
### Consistency(一致性)
数据库总是从一个一致性的状态转换到另一个一致性的状态。
### Isolation(隔离性)
指并发的事务之间不会互相影响，如果一个事务要访问的数据正在被另外一个事务修改，只要另外一个事务未提交，它所访问的数据就不受未提交事务的影响。
### Durability(持久性)
指一旦事务提交后，它所做的修改将会永久的保存在数据库上，即使出现宕机也不会丢失。
<h2>事务的并发问题</h2>
并发事务时，可能会产生以下问题

### 脏读
A事务读取B事务尚未提交的更改数据，并在这个数据的基础上进行操作，这时候如果事务B回滚，那么A事务读到的数据是不被承认的。
### 不可重复读
A事务多次读取同一数据，B事务在A事务多次读取的过程中，对数据作了更新并提交，导致A事务多次读取同一数据时，结果不一致。
### 幻读
A事务读取B事务提交的新增数据。

不可重复读与幻读的区别：前者是指读到已经提交的事务的更改数据，后者是指读到了其他已经提交事务的新增数据。解决不可重复读可通过行锁，解决幻读可通过表锁。

<h2>事务隔离级别</h2>
<table>
<tr>
<td>事务隔离级别</td><td>脏读</td><td>不可重复读</td><td>幻读</td>
</tr>
<tr>
<td>读未提交（read-uncommitted）</td><td>是</td><td>是</td><td>是</td>
</tr>
<tr>
<td>不可重复读（read-committed）</td><td>否</td><td>是</td><td>是</td>
</tr>
<tr>
<td>可重复读（repeatable-read）</td><td>否</td><td>否</td><td>是</td>
</tr>
<tr>
<td>串行化（serializable）</td><td>否</td><td>否</td><td>否</td>
</tr>
</table>

事务隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能的影响也越大。

